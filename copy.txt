exports.updateUser = async (req, res) => {
  const { id } = req.params;
  const {
    username,
    email,
    password,
    full_name,
    phone,
    address,
    avatar,
    role,
    birthday,
    gender,
  } = req.body;

  const sanitize = (value) => (value === undefined ? null : value);

  const avatarFromFile = req.file ? `/uploads/${req.file.filename}` : undefined;

  try {
    await User.update({
      id: parseInt(id),
      username: sanitize(username),
      email: sanitize(email),
      password: sanitize(password),
      full_name: sanitize(full_name),
      phone: sanitize(phone),
      address: sanitize(address),
      avatar: sanitize(avatarFromFile || avatar), // 游녣 퀊u ti칡n file upload
      role: sanitize(role),
      birthday: sanitize(birthday),
      gender: sanitize(gender),
    });

    res.json({ message: "C故셣 nh故셦 th맕h c칪ng." });
  } catch (error) {
    console.error("L敲들 c故셣 nh故셦 ng퀋敲렬 d칯ng:", error.message);
    res.status(500).json({ error: "L敲들 c故셣 nh故셦 ng퀋敲렬 d칯ng." });
  }
};